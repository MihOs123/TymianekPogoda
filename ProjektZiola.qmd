---
title: "PowiÄ…zania miÄ™dzy warunkami pogodowymi a iloÅ›ciÄ… zbiorÃ³w oraz jakoÅ›ciÄ… tymianku"
author: "MichaÅ‚ KozioÅ‚"
format:
  html: 
    theme: cosmo (HTML Theming â€“ Quarto) 
    toc: true
    toc-location: left
    toc-depth: 3 
    toc-title: "Spis TreÅ›ci"
    smooth-scroll: true
    self-contained: true
    code-fold: true
    warning: false
    echo: false
---

# WstÄ™p

```{r}
library(ggplot2)
library(dplyr)
library(tidyselect)
library(tidyverse)
library(lubridate)
library(stringr)
library(ggridges)
options(scipen=999)

library(tidyverse)
library(viridis)
library(gt)
library(gtExtras)


library(plotly)


library(corrplot)
```

Analiza bada powiÄ…zania miÄ™dzy warunkami pogodowymi a iloÅ›ciÄ… oraz jakoÅ›ciÄ… zbiorÃ³w tymianku.

ZnajomoÅ›Ä‡ korelacji miÄ™dzy pogodÄ… a spodziewanymi zbiorami byÅ‚oby korzystne dla rolnikÃ³w i hurtowni.

# Pytania badawcze i hipotezy

**Pytanie 1**: Jak wilgotnoÅ›Ä‡ w pogodzie wpÅ‚ywa na jakoÅ›Ä‡ i iloÅ›Ä‡ tymianku?

-   **Hipoteza 1.1**: Stan wody w najbliÅ¼szej mierzonej rzece nie ma istotnego wpÅ‚ywu na uprawÄ™ tymianku.
-   **Hipoteza 1.2**: Åšrednia wilgotnoÅ›Ä‡ ma istotny wpÅ‚yw na wilgoÄ‡ mierzonÄ… w tymianku oraz jego jakoÅ›Ä‡.
-   **Hipoteza 1.3**: Opady w miesiÄ…cach zbiorÃ³w tymianku negatywnie wpÅ‚ywajÄ… na jego jakoÅ›Ä‡.
-   **Hipoteza 1.4**: Opady w miesiÄ…cach wzrostu tymianku pozytywnie wpÅ‚ywajÄ… na jego iloÅ›Ä‡.

**Pytanie 2**: Jak sytuacja przy gruncie wpÅ‚ywa na jakoÅ›Ä‡ i iloÅ›Ä‡ tymianku?

-   **Hipoteza 2.1**: Minimalna temperatura gruntu w miesiÄ…cach wzrostu tymianku ma wpÅ‚yw na jego ililoÅ›Ä‡ i jakoÅ›Ä‡ w okresie zbiorÃ³w.
-   **Hipoteza 2.2**: IloÅ›Ä‡ dni z zaobserwowanÄ… rosÄ… w miesiÄ…cach wzrostu tymianku ma wpÅ‚yw na jego iloÅ›Ä‡ i jakoÅ›Ä‡ w okresie zbiorÃ³w.

**Pytanie 3**: Jak warunki atmosferyczne wpÅ‚ywajÄ… na jakoÅ›Ä‡ i iloÅ›Ä‡ tymianku?

-   **Hipoteza 3.1**: DuÅ¼e nasÅ‚onecznienie w miesiÄ…cach zbiorÃ³w tymianku pozytywnie wpÅ‚ywajÄ… na jego jakoÅ›Ä‡.
-   **Hipoteza 3.2**: DuÅ¼e nasÅ‚onecznienie w miesiÄ…cach siania tymianku negatywnie wpÅ‚ywajÄ… na jego iloÅ›Ä‡ podczas zbiorÃ³w.
-   **Hipoteza 3.3**: CiÅ›nienie atmosferyczne nie wpÅ‚ywa znacznie na jakoÅ›Ä‡ upraw tymianku.
-   **Hipoteza 3.4**: PrÄ™dkoÅ›Ä‡ wiatru nie wpÅ‚ywa znacznie na jakoÅ›Ä‡ upraw tymianku.

# Eksploracja zbioru danych

## Dane Zielarskie

Dane dotyczÄ…ce zbiorÃ³w tymianku zostaÅ‚y podarowane przez firmÄ™ prowadzÄ…cÄ… skup od lokalnych rolnikÃ³w.

Podstawowe dane zielarskie zawierajÄ… datÄ™ przyjÄ™cia ziÃ³Å‚ w hurtowni, ich wagÄ™, wilgoÄ‡ oraz stÄ™Å¼enie olejkÃ³w eterycznych. Olejki eteryczne sÄ… gÅ‚Ã³wnÄ… miarÄ… jego jakoÅ›ci.

```{r}
Ziola <- read.csv("Ziola.csv")
Ziola %>%
summarise(
  "Åšrednia waga" = round(mean(Waga)),
  "Åšrednie olejki" = round(mean(Olej), digits = 2),
  "Åšrednia wilgoÄ‡" = round(mean(Wilg), digits = 2)
) %>%
  gt() %>%
  gt_theme_dot_matrix()
```

Do kaÅ¼dego rekordu jest takÅ¼e przypisany sezon. Tymianek sieje siÄ™ w okolicach kwietnia a zbiera od poÅ‚owy wrzeÅ›nia do paÅºdziernika/listopoada. GÅ‚Ã³wny skup trwa od wrzeÅ›nia do czerwca.

```{r}
###Obczajanie zbioru ziÃ³Å‚
Ziola <- read.csv("Ziola.csv")
Ziola %>%
  group_by(Miesiac) %>%
  summarise(Waga = sum(Waga)) %>%
  ggplot(aes(x=Miesiac, y=Waga))+
  scale_x_continuous(breaks=seq(0,12,by=1))+
  geom_bar(fill="darkgreen", stat = "identity")+
  labs(x="MiesiÄ…c", y="ÅÄ…czna waga przyjÄ™tego tymianku")+
  theme_light()
```

W lipcu i sierpniu skupuje siÄ™ o wiele mniej towaru, dlatego te miesiÄ…ce nie bÄ™dÄ… uwzglÄ™dniane. SzczegÃ³Å‚owe, uÅ¼yteczne dane zbierane sÄ… dopiero od poÅ‚owy 2019 roku, wiÄ™c nie bÄ™dzie brany pod uwagÄ™ sezon 2018. Luki w informacjach o wartoÅ›ci olejkÃ³w oraz wilgoci zostaÅ‚y wypeÅ‚nione Å›redniÄ… wartoÅ›ciÄ… (2.2057 dla oleju i 6.2719 dla wilgoci).

```{r}
Ziola_Szczuple <- Ziola %>%
  filter(Miesiac %in% c(1,2,3,4,5,6,9,10,11,12))
Ziola_Szczuple <- Ziola_Szczuple %>%
  filter(Rok_Prod != 18) %>%
  group_by(DataKod) %>%
  summarise(Rok = mean(Rok),
            Miesiac = mean(Miesiac),
            Sezon = max(Rok_Prod)+2000,
            Sum_Waga = sum(Waga),
            Srd_Waga = mean(Waga),
            Wilg = mean(Wilg),
            Olej = mean(Olej))

# quantile(Ziola_Szczuple$Olej)

Ziola_Szczuple <- Ziola_Szczuple %>%
  mutate(
    Jakosc = case_when(
      Olej <= 2.123365 ~ 1,
      Olej <= 2.198366 ~ 2,
      Olej <= 2.304921 ~ 3,
      Olej <= 2.637983 ~ 4
    )
  )


#################
Ziola_NIESzczuple <- Ziola %>%
  filter(Miesiac %in% c(1,2,3,4,5,6,9,10,11,12))

#quantile(Ziola_NIESzczuple$Olej)

Ziola_NIESzczuple <- Ziola_NIESzczuple %>%
  mutate(
    Sezon = Rok_Prod+2000,
    Jakosc = case_when(
      Olej <= 2.060000 ~ 1,
      Olej <= 2.212917 ~ 2,
      Olej <= 2.353333 ~ 3,
      Olej <= 3.280000 ~ 4
    )
  ) %>%
  select(-Rok_Prod)
```

::: panel-tabset
## Waga a Olej

```{r}
p<-ggplot(Ziola_NIESzczuple, aes(x=Waga, y=Olej, color = as.character(Sezon))) +
  geom_point()+
  theme_light()+
  labs(color = "Sezon", x = "ÅÄ…czna waga", y = "StÄ™Å¼enie olejkÃ³w",
       caption = paste0("Korelacja: ",
                        round(cor(Ziola_NIESzczuple$Waga, Ziola_NIESzczuple$Olej,
                                  use = "complete.obs"), digits = 3)))

ggplotly(p)
```

## Waga a WilgoÄ‡

```{r}
p<-ggplot(Ziola_NIESzczuple, aes(x=Waga, y=Wilg, color = as.character(Sezon))) +
  geom_point()+
  theme_light()+
  labs(color = "Sezon", x = "ÅÄ…czna waga", y = "WilgoÄ‡",
       caption = paste0("Korelacja: ",
                        round(cor(Ziola_NIESzczuple$Waga, Ziola_NIESzczuple$Wilg,
                                  use = "complete.obs"), digits = 3)))

ggplotly(p)
```

## WilgoÄ‡ a Olej

```{r}
p<-ggplot(Ziola_NIESzczuple, aes(x=Wilg, y=Olej, color = as.character(Sezon))) +
  geom_point()+
  theme_light()+
  labs(color = "Sezon", x = "WilgoÄ‡", y = "StÄ™Å¼enie olejkÃ³w",
       caption = paste0("Korelacja: ",
                        round(cor(Ziola_NIESzczuple$Wilg, Ziola_NIESzczuple$Olej,
                                  use = "complete.obs"), digits = 3)))
ggplotly(p)
```
:::

## Dane Metorologiczne

Dane pogodowe zostaÅ‚y zebrane z publicznych archiwÃ³w IMGW.

W bezpoÅ›redniej okolicy uprawianego tymianku nie ma zbieranych danych pogodowych, wiÄ™c zostaÅ‚y one zagregowane z kilku lokacji w woj. lubelskim.

Pewne szczegÃ³Å‚owe dane pogodowe, takie jak suma dni z zaobserwowanÄ… rosÄ… albo stan wody w najbliÅ¼szej istotnej rzece koÅ„czÄ… siÄ™ na poczÄ…tku 2024 roku. Te bardziej ogÃ³lne, takie jak Å›rednia temperatura czy ciÅ›nienie atmosferyczne koÅ„czÄ… siÄ™ w poÅ‚owie 2024.

Miara opadÃ³w zostaÅ‚a stworzona przez zÅ‚Ä…czenie podobnych danych pogodowych

```{r}
###Obrobienie zbioru pogody
#Dane rzekowe
Wieprz <- read.csv("Wieprz_Combo.csv")
Wieprz <- Wieprz %>%
  filter(Ekst == 2) %>%
  mutate(DataKod = paste(Rok, str_pad(Mies_Kalendarz, 2, pad = "0"), sep = "-")) %>%
  select(-Ekst, -Rzeka)

#Dane pogodowe
Pogoda <- read.csv("Pogoda_Combo.csv")

Pogoda <- Pogoda |>
  mutate(DataKod = paste(Rok, str_pad(Mies, 2, pad = "0"), sep = "-"))

Pogoda <- Pogoda %>%
  group_by(DataKod) %>% 
  summarise(Rok = mean(Rok, na.rm=T),
            Mies = mean(Mies, na.rm=T),
            Sred_Temp = mean(Sred_Temp, na.rm=T),
            Max_Temp = mean(Abs_Temp_Max, na.rm=T),
            Min_Temp = mean(Abs_Temp_Min, na.rm=T),
            Min_Temp_Grunt = mean(Min_Temp_Grunt, na.rm=T),
            Srd_Wiatr = mean(Wiatr, na.rm=T),
            Srd_Wilgot = mean(Sred_Wilgot, na.rm=T),
            Srd_Cisn = mean(Sred_Cisn, na.rm=T),
            Suma_Slonce = mean(Suma_Slonce, na.rm=T),
            Zachmurz = mean(Zachmurz, na.rm=T),
            Suma_Opad = mean(Suma_Opad, na.rm=T),
            Maks_Dob_Sum_Opad = mean(Maks_Dob_Sum_Opad, na.rm=T),
            Suma_Opadu_Dzien = mean(Suma_Opadu_Dzien, na.rm=T),
            Suma_Opadu_Noc = mean(Suma_Opadu_Noc, na.rm=T),
            Dni_Z_Deszcz = mean(Dni_Z_Deszcz, na.rm=T),
            Dni_Wiatr = mean(Dni_Wiatr, na.rm=T),
            Dni_Rosa = mean(Dni_Rosa, na.rm=T))
```

## Zakres ZbiorÃ³w

Limitacje zbiorÃ³w metorologicznych oraz zielarskich oznaczajÄ…, Å¼e analizie poddane bÄ™dÄ… sezony uprawy 2019 - 2023 (czyli od wrzeÅ›nia 2019 do czerwca 2024)

```{r}

#PoÅ‚Ä…czenie danych
Main <- left_join(
  Ziola_Szczuple,
  Pogoda %>% select(-Rok, -Mies),
  by = "DataKod"
)
Main <- left_join(
  Main,
  Wieprz %>% select(-Rok, -Mies_Kalendarz),
  by = "DataKod"
)

MainGRUBY <- left_join(
  Ziola_NIESzczuple,
  Pogoda %>% select(-Rok, -Mies),
  by = "DataKod"
)
MainGRUBY <- left_join(
  MainGRUBY,
  Wieprz %>% select(-Rok, -Mies_Kalendarz),
  by = "DataKod"
)

#Dane Å¼eby byÅ‚y Å‚adnie pokazane w miesiacach wzrostu i zbiorow
Pogoda_Rosnie <- MainGRUBY %>%
  filter(Miesiac %in% c(5, 6, 7, 8)) %>%
  group_by(Rok) %>%
  summarise(Sezon = mean(Rok)+2000,
            Sred_Temp = mean(Sred_Temp, na.rm=T),
            Max_Temp = max(Max_Temp, na.rm=T),
            Min_Temp = min(Min_Temp, na.rm=T),
            Min_Temp_Grunt = min(Min_Temp_Grunt, na.rm=T),
            Srd_Wiatr = mean(Srd_Wiatr, na.rm=T),
            Srd_Wilgot = mean(Srd_Wilgot, na.rm=T),
            Srd_Cisn = mean(Srd_Cisn, na.rm=T),
            Suma_Slonce = sum(Suma_Slonce, na.rm=T),
            Zachmurz = sum(Zachmurz, na.rm=T),
            Suma_Opad = sum(Suma_Opad, na.rm=T),
            Maks_Dob_Sum_Opad = max(Maks_Dob_Sum_Opad, na.rm=T),
            Suma_Opadu_Dzien = sum(Suma_Opadu_Dzien, na.rm=T),
            Suma_Opadu_Noc = sum(Suma_Opadu_Noc, na.rm=T),
            Dni_Z_Deszcz = sum(Dni_Z_Deszcz, na.rm=T),
            Dni_Wiatr = sum(Dni_Wiatr, na.rm=T),
            Dni_Rosa = sum(Dni_Rosa, na.rm=T)) %>%
  select(-Rok)
Main_GdyRosnie <- left_join(Ziola_NIESzczuple, Pogoda_Rosnie, by = "Sezon")
Main_GdyRosnie <- Main_GdyRosnie %>%
  filter(Sezon %in% c(2019, 2020, 2021, 2022, 2023, 2024))

Pogoda_Zbiory <- MainGRUBY %>%
  filter(Miesiac %in% c(9, 10, 11)) %>%
  group_by(Rok) %>%
  summarise(Sezon = mean(Rok)+2000,
            Sred_Temp = mean(Sred_Temp, na.rm=T),
            Max_Temp = max(Max_Temp, na.rm=T),
            Min_Temp = min(Min_Temp, na.rm=T),
            Min_Temp_Grunt = min(Min_Temp_Grunt, na.rm=T),
            Srd_Wiatr = mean(Srd_Wiatr, na.rm=T),
            Srd_Wilgot = mean(Srd_Wilgot, na.rm=T),
            Srd_Cisn = mean(Srd_Cisn, na.rm=T),
            Suma_Slonce = sum(Suma_Slonce, na.rm=T),
            Zachmurz = sum(Zachmurz, na.rm=T),
            Suma_Opad = sum(Suma_Opad, na.rm=T),
            Maks_Dob_Sum_Opad = max(Maks_Dob_Sum_Opad, na.rm=T),
            Suma_Opadu_Dzien = sum(Suma_Opadu_Dzien, na.rm=T),
            Suma_Opadu_Noc = sum(Suma_Opadu_Noc, na.rm=T),
            Dni_Z_Deszcz = sum(Dni_Z_Deszcz, na.rm=T),
            Dni_Wiatr = sum(Dni_Wiatr, na.rm=T),
            Dni_Rosa = sum(Dni_Rosa, na.rm=T)) %>%
  select(-Rok)
Main_GdyZbiory <- left_join(Ziola_NIESzczuple, Pogoda_Zbiory, by = "Sezon")
Main_GdyZbiory <- Main_GdyZbiory %>%
  filter(Sezon %in% c(2019, 2020, 2021, 2022, 2023, 2024))
#rm(Pogoda_Rosnie, Pogoda_Zbiory, Wieprz, Ziola, Pogoda, Ziola_Szczuple)
```

# Pytanie 1

"Jak wilgotnoÅ›Ä‡ w pogodzie wpÅ‚ywa na jakoÅ›Ä‡ i iloÅ›Ä‡ tymianku?"

## OdpowiedÅº na hipotezÄ™ 1.1

"Stan wody w najbliÅ¼szej mierzonej rzece nie ma istotnego wpÅ‚ywu na uprawÄ™ tymianku"

::: panel-tabset
## Stan wody a olejki

```{r}
kr <- cor.test(Main$Stan_Wody, Main$Olej, method = "pearson", use = "complete.obs")

ggplot(Main, aes(x=Stan_Wody, y=Olej, color = as.character(Sezon))) + 
  geom_smooth(method=lm , color="darkgreen", se=FALSE) +
  geom_point()+
  theme_light()+
  labs(x="Stan wody w najbliÅ¼szej istotnej rzece [w cm]",
       y="StÄ™Å¼enie olejkÃ³w",
       color = "Sezon",
       caption = paste0("Korelacja: ",
                        round(kr$estimate, digits = 3),
                        " | P: ",
                        round(kr$p.value, digits = 3)))
```

*SÅ‚aba korelacja istotna statystycznej.*

## Stan wody a wilgotnoÅ›Ä‡

```{r}
kr <- cor.test(Main$Stan_Wody, Main$Wilg, method = "pearson", use = "complete.obs")

ggplot(Main, aes(x=Stan_Wody, y=Wilg, color = as.character(Sezon))) + 
  geom_smooth(method=lm , color="darkgreen", se=FALSE) +
  geom_point()+
  theme_light()+
  labs(x="Stan wody w najbliÅ¼szej istotnej rzece [w cm]",
       y="WilgoÄ‡ ziÃ³Å‚",
       color = "Sezon",
       caption = paste0("Korelacja: ",
                        round(kr$estimate, digits = 3),
                        " | P: ",
                        round(kr$p.value, digits = 3)))
```

*Brak korelacji.*
:::

O dziwo istnieje korelacja miÄ™dzy stanem wody a olejkami. Najprawdopodobniej nie jest to jednak bezpoÅ›redni wpÅ‚yw rzeki a efekt opadÃ³w (ktÃ³re bÄ™dÄ… sprawdzane w hipotezie 1.3).

**Hipoteza**: Potwierdzona ğŸŸ¢

## OdpowiedÅº na hipotezÄ™ 1.2

"Åšrednia wilgotnoÅ›Ä‡ ma istotny wpÅ‚yw na wilgoÄ‡ mierzonÄ… w tymianku oraz jego jakoÅ›Ä‡"

::: panel-tabset
## WilgotnoÅ›Ä‡ a wilgoÄ‡

```{r}
kr <- cor.test(Main$Srd_Wilgot, Main$Wilg, method = "pearson", use = "complete.obs")

ggplot(Main, aes(x=Srd_Wilgot, y=Wilg, color = as.character(Sezon))) + 
  geom_smooth(method=lm , color="darkgreen", se=FALSE) +
  geom_point()+
  theme_light()+
  labs(x="Åšrednia wilgotnoÅ›Ä‡ wzglÄ™dna [w %]",
       y="WilgoÄ‡ ziÃ³Å‚",
       color = "Sezon",
       caption = paste0("Korelacja: ",
                        round(kr$estimate, digits = 3),
                        " | P: ",
                        round(kr$p.value, digits = 3)))
```

*Umiarkowana, wysoce istotna statystycznie korelacja.*

## WilgotnoÅ›Ä‡ a olejki

```{r}
kr <- cor.test(Main$Srd_Wilgot, Main$Olej, method = "pearson", use = "complete.obs")

ggplot(Main, aes(x=Srd_Wilgot, y=Olej, color = as.character(Sezon))) + 
  geom_smooth(method=lm , color="darkgreen", se=FALSE) +
  geom_point()+
  theme_light()+
  labs(x="Åšrednia wilgotnoÅ›Ä‡ wzglÄ™dna [w %]",
       y="StÄ™Å¼enie olejkÃ³w",
       color = "Sezon",
       caption = paste0("Korelacja: ",
                        round(kr$estimate, digits = 3),
                        " | P: ",
                        round(kr$p.value, digits = 3)))
```

*Brak korelacji.*
:::

ZaskakujÄ…co, im wiÄ™ksza wilgotnoÅ›Ä‡ tym mniej wilgotne zioÅ‚a.

OdpowiedÅº kryje siÄ™ w charakterze badanych danych. WilgoÄ‡ w zioÅ‚ach mierzona jest po suszeniu. Im wiÄ™ksza wilgotnoÅ›Ä‡ wzglÄ™dna wymaga duÅ¼o wiÄ™kszego suszenia wiÄ™c produkuje takÅ¼e suchsze zioÅ‚a.

**Hipoteza**: CzÄ™Å›ciowo potwierdzona ğŸŸ¢

## OdpowiedÅº na hipotezÄ™ 1.3

"Opady w miesiÄ…cach zbiorÃ³w tymianku negatywnie wpÅ‚ywajÄ… na jego jakoÅ›Ä‡"

```{r}
MainTMP <- Main_GdyZbiory %>%
  filter(Suma_Opad > 0) %>%
  mutate(
    Miara_Opadow = Suma_Opad + Maks_Dob_Sum_Opad*100 + Suma_Opadu_Dzien + Suma_Opadu_Noc + Dni_Z_Deszcz*10,
    Miara_Opadow = round(Miara_Opadow),
    Miara_Opadow_Kat = cut(Miara_Opadow, breaks = quantile(Miara_Opadow, probs = seq(0, 1, 0.25)), labels = c("Niska (Q1)", "Åšredno-niska (Q2)", "Åšredno-wysoka (Q3)", "Wysoka (Q4)"), include.lowest = TRUE)
  )

kr <- cor.test(MainTMP$Olej, MainTMP$Miara_Opadow, method = "pearson", use = "complete.obs")

MainTMP %>%
ggplot(aes(x=Olej, y=Miara_Opadow_Kat, fill=as.character(Sezon))) + 
  geom_boxplot() +
  geom_vline(xintercept = 2.2, linewidth = 1, color="black", se=FALSE) +
  theme_light()+
  labs(x="StÄ™Å¼enie olejkÃ³w",
       y="Miara OpadÃ³w",
       fill = "Sezon",
       caption = paste0("Korelacja: ",
                        round(kr$estimate, digits = 3),
                        " | P: ",
                        round(kr$p.value, digits = 3)))
rm(MainTMP)
```

*Bardzo sÅ‚aba, istotna statystycznie korelacja.*

Wbrew temu czego moÅ¼naby siÄ™ spodziewaÄ‡ z hipotezy 1.1, bezpoÅ›rednie dane o opadach sÅ‚abiej korelujÄ… z ich jakoÅ›ciÄ…. Dodatkowo moÅ¼na zauwaÅ¼yÄ‡, Å¼e najlepsze stÄ™Å¼enie olejkÃ³w jest podczas Å›rednich opadÃ³w.

**Hipoteza**: Obalona ğŸ”´

## OdpowiedÅº na hipotezÄ™ 1.4

"Opady w miesiÄ…cach wzrostu tymianku pozytywnie wpÅ‚ywajÄ… na jego iloÅ›Ä‡"

```{r}
MainTMP <- Main_GdyRosnie %>%
  filter(Suma_Opad > 0, Waga < 9000) %>%
  mutate(
    Miara_Opadow = Suma_Opad + Maks_Dob_Sum_Opad*100 + Suma_Opadu_Dzien + Suma_Opadu_Noc + Dni_Z_Deszcz*10,
    Miara_Opadow = round(Miara_Opadow),
    Miara_Opadow_Kat = cut(Miara_Opadow, breaks = quantile(Miara_Opadow, probs = seq(0, 1, 0.25)), labels = c("Niska (Q1)", "Åšredno-niska (Q2)", "Åšredno-wysoka (Q3)", "Wysoka (Q4)"), include.lowest = TRUE)
  )

kr <- cor.test(MainTMP$Waga, MainTMP$Miara_Opadow, method = "pearson", use = "complete.obs")

MainTMP %>%
ggplot(aes(x=Waga, y=Miara_Opadow_Kat, fill=as.character(Sezon))) + 
  geom_boxplot() +
  geom_vline(xintercept = 2991, linewidth = 1, color="black", se=FALSE) +
  theme_light()+
  labs(x="StÄ™Å¼enie olejkÃ³w",
       y="Miara OpadÃ³w",
       fill = "Sezon",
       caption = paste0("Korelacja: ",
                        round(kr$estimate, digits = 3),
                        " | P: ",
                        round(kr$p.value, digits = 3)))
rm(MainTMP)
```

*Brak korelacji.*

**Hipoteza**: Obalona ğŸ”´

## Podsumowanie pytania 1

"Jak wilgotnoÅ›Ä‡ w pogodzie wpÅ‚ywa na jakoÅ›Ä‡ i iloÅ›Ä‡ tymianku?"

-   Im wyÅ¼szy stan wody w rzekach tym niÅ¼sze olejki w zioÅ‚ach.

-   Im wiÄ™ksza wilgotnoÅ›Ä‡ tym mniejsza wilgoÄ‡ ziÃ³Å‚ (spowodowane nadmiernym suszeniem).

-   Åšrednie opady w miesiÄ…cach zbiorÃ³w majÄ… pozytywny wpÅ‚ywaÄ‡ na jakoÅ›Ä‡ tymianku.

------------------------------------------------------------------------

------------------------------------------------------------------------

------------------------------------------------------------------------

# Pytanie 2

"Jak sytuacja przy gruncie wpÅ‚ywa na jakoÅ›Ä‡ i iloÅ›Ä‡ tymianku?"

## OdpowiedÅº na hipotezÄ™ 2.1

"Minimalna temperatura gruntu w miesiÄ…cach wzrostu tymianku ma wpÅ‚yw na jego iloÅ›Ä‡ i jakoÅ›Ä‡ w okresie zbiorÃ³w."

::: panel-tabset
## Temperatura a waga

```{r}
kr <- cor.test(Main_GdyRosnie$Waga, Main_GdyRosnie$Min_Temp_Grunt, method = "pearson", use = "complete.obs")

ggplot(Main_GdyRosnie, aes(x=Waga, y=as.character(Min_Temp_Grunt), fill=as.character(Sezon))) + 
  geom_boxplot() +
  geom_vline(xintercept = 2991, linewidth = 1, color="black", se=FALSE) +
  theme_light()+
  labs(y="Minimalna temperatura gruntu [w C]",
       x="Waga przyjÄ™tych zioÅ‚ [kg]",
       fill = "Sezon",
       caption = paste0("Korelacja: ",
                        round(kr$estimate, digits = 3),
                        " | P: ",
                        round(kr$p.value, digits = 3)))
```

*Brak korelacji*

## Temperatura a jakoÅ›Ä‡

```{r}
kr <- cor.test(Main_GdyRosnie$Olej, Main_GdyRosnie$Min_Temp_Grunt, method = "pearson", use = "complete.obs")

ggplot(Main_GdyRosnie, aes(x=Olej, y=as.character(Min_Temp_Grunt), fill=as.character(Sezon))) + 
  geom_boxplot() +
  geom_vline(xintercept = 2.2, linewidth = 1, color="black", se=FALSE) +
  theme_light()+
  labs(y="Minimalna temperatura gruntu [w C]",
       x="StÄ™Å¼enie olejkÃ³w",
       fill = "Sezon",
       caption = paste0("Korelacja: ",
                        round(kr$estimate, digits = 3),
                        " | P: ",
                        round(kr$p.value, digits = 3)))
```

*SÅ‚aba, istotna statystycznie korelacja.*
:::

Hipoteza: CzÄ™Å›ciowo obalona ğŸŸ¡

## OdpowiedÅº na hipotezÄ™ 2.2

"IloÅ›Ä‡ dni z zaobserwowanÄ… rosÄ… w pierwszych miesiÄ…cach wzrostu tymianku ma wpÅ‚yw na jego iloÅ›Ä‡ i jakoÅ›Ä‡ w okresie zbiorÃ³w."

::: panel-tabset
## Rosa a iloÅ›Ä‡

```{r}
kr <- cor.test(Main_GdyRosnie$Waga, Main_GdyRosnie$Dni_Rosa, method = "pearson", use = "complete.obs")

Main_GdyRosnie %>%
  filter(Dni_Rosa != 0) %>%
ggplot(aes(x=Waga, y=Dni_Rosa, fill=as.character(Sezon))) + 
  geom_boxplot() +
  geom_vline(xintercept = 2991, linewidth = 1, color="darkgreen", se=FALSE) +
  theme_light()+
  labs(y="Liczba dni z zaobserwowanÄ… rosÄ…",
       x="Waga przyjÄ™tych zioÅ‚ [kg]",
       fill = "Sezon",
       caption = paste0("Korelacja: ",
                        round(kr$estimate, digits = 3),
                        " | P: ",
                        round(kr$p.value, digits = 3)))
```

*Brak korelacji.*

## Rosa a jakoÅ›Ä‡

```{r}
kr <- cor.test(Main_GdyRosnie$Olej, Main_GdyRosnie$Dni_Rosa, method = "pearson", use = "complete.obs")

Main_GdyRosnie %>%
  filter(Dni_Rosa != 0) %>%
ggplot(aes(x=Olej, y=Dni_Rosa, fill=as.character(Sezon))) + 
  geom_boxplot() +
  geom_vline(xintercept = 2.2, linewidth = 1, color="darkgreen", se=FALSE) +
  theme_light()+
  labs(y="Liczba dni z zaobserwowanÄ… rosÄ…",
       x="StÄ™Å¼enie olejkÃ³w",
       fill = "Sezon",
       caption = paste0("Korelacja: ",
                        round(kr$estimate, digits = 3),
                        " | P: ",
                        round(kr$p.value, digits = 3)))
```

*Brak korelacji.*
:::

Dziury w specyficznych danych pogodowych zostawiajÄ… tylko 3 sezony.

Hipoteza: Obalona ğŸ”´

## Podsumowanie pytania 2

"Jak sytuacja przy gruncie wpÅ‚ywa na jakoÅ›Ä‡ i iloÅ›Ä‡ tymianku?"

-   Dane nie pokazaÅ‚y Å¼adnej istotnej korelacji pomiÄ™dzy sytuacjÄ… przy gruncie a iloÅ›ciÄ… tymianku

-   CiepÅ‚y grunt podczas wzrostu tymianku ma lekki pozytywny wpÅ‚yw na jego jakoÅ›Ä‡

------------------------------------------------------------------------

------------------------------------------------------------------------

------------------------------------------------------------------------

# Pytanie 3

"Jak warunki atmosferyczne wpÅ‚ywajÄ… na jakoÅ›Ä‡ i iloÅ›Ä‡ tymianku?"

## OdpowiedÅº na hipotezÄ™ 3.1

"DuÅ¼e nasÅ‚onecznienie w miesiÄ…cach zbiorÃ³w tymianku pozytywnie wpÅ‚ywajÄ… na jego iloÅ›Ä‡ i jakoÅ›Ä‡."

::: panel-tabset
## NasÅ‚onecznienie a iloÅ›Ä‡

```{r}
kr <- cor.test(Main_GdyZbiory$Waga, Main_GdyZbiory$Suma_Slonce, method = "pearson", use = "complete.obs")

Main_GdyZbiory %>%
  filter(Suma_Slonce != 0) %>%
ggplot(aes(y=as.factor(round(Suma_Slonce)), x=Waga, fill=as.character(Sezon))) + 
  geom_boxplot() +
  geom_vline(xintercept = 2991, linewidth = 1, color="black", se=FALSE) +
  theme_light()+
  labs(y="Suma nasÅ‚onecznienia [w godz.]",
       x="Waga przyjÄ™tych zioÅ‚ [kg]",
       fill = "Sezon",
       caption = paste0("Korelacja: ",
                        round(kr$estimate, digits = 3),
                        " | P: ",
                        round(kr$p.value, digits = 3)))
```

*Brak korelacji.*

## NasÅ‚onecznienie a jakoÅ›Ä‡

```{r}
kr <- cor.test(Main_GdyZbiory$Olej, Main_GdyZbiory$Suma_Slonce, method = "pearson", use = "complete.obs")

Main_GdyZbiory %>%
  filter(Suma_Slonce != 0) %>%
ggplot(aes(y=as.factor(round(Suma_Slonce)), x=Olej, fill=as.character(Sezon))) +
  geom_boxplot() +
  geom_vline(xintercept = 2.2, linewidth = 1, color="black", se=FALSE) +
  theme_light()+
  labs(y="Suma nasÅ‚onecznienia [w godz.]",
       x="JakoÅ›Ä‡ ziÃ³Å‚ [wskaÅºnik olejkÃ³w]",
       fill = "Sezon",
       caption = paste0("Korelacja: ",
                        round(kr$estimate, digits = 3),
                        " | P: ",
                        round(kr$p.value, digits = 3)))
```

*Brak korelacji.*
:::

**Hipoteza**: Obalona ğŸ”´

## OdpowiedÅº na hipotezÄ™ 3.2

"DuÅ¼e nasÅ‚onecznienie w miesiÄ…cach siania tymianku negatywnie wpÅ‚ywajÄ… na jego iloÅ›Ä‡ i jakoÅ›Ä‡."

::: panel-tabset
## NasÅ‚onecznienie a iloÅ›Ä‡

```{r}
kr <- cor.test(Main_GdyRosnie$Waga, Main_GdyRosnie$Suma_Slonce, method = "pearson", use = "complete.obs")

Main_GdyRosnie %>%
  filter(Suma_Slonce != 0) %>%
ggplot(aes(y=as.factor(round(Suma_Slonce)), x=Waga, fill=as.character(Sezon))) + 
  geom_boxplot() +
  geom_vline(xintercept = 2991, linewidth = 1, color="black", se=FALSE) +
  theme_light()+
  labs(y="Suma nasÅ‚onecznienia [w godz.]",
       x="Waga przyjÄ™tych zioÅ‚ [kg]",
       fill = "Sezon",
       caption = paste0("Korelacja: ",
                        round(kr$estimate, digits = 3),
                        " | P: ",
                        round(kr$p.value, digits = 3)))
```

*SÅ‚aba, istotna statystycznie korelacja.*

## NasÅ‚onecznienie a jakoÅ›Ä‡

```{r}
kr <- cor.test(Main_GdyRosnie$Olej, Main_GdyRosnie$Suma_Slonce, method = "pearson", use = "complete.obs")

Main_GdyRosnie %>%
  filter(Suma_Slonce != 0) %>%
ggplot(aes(y=as.factor(round(Suma_Slonce)), x=Olej, fill=as.character(Sezon))) + 
  geom_boxplot() +
  geom_vline(xintercept = 2.2, linewidth = 1, color="black", se=FALSE) +
  theme_light()+
  labs(y="Suma nasÅ‚onecznienia [w godz.]",
       x="JakoÅ›Ä‡ ziÃ³Å‚ [wskaÅºnik olejkÃ³w]",
       fill = "Sezon",
       caption = paste0("Korelacja: ",
                        round(kr$estimate, digits = 3),
                        " | P: ",
                        round(kr$p.value, digits = 3)))
```

*Brak korelacji.*
:::

**Hipoteza**: Obalona ğŸ”´

## OdpowiedÅº na hipotezÄ™ 3.3

"CiÅ›nienie atmosferyczne nie wpÅ‚ywa znacznie na jakoÅ›Ä‡ upraw tymianku."

::: panel-tabset
## Korelacja w momencie przyjÄ™cia

```{r}
kr <- cor.test(MainGRUBY$Olej, MainGRUBY$Srd_Cisn, method = "pearson", use = "complete.obs")

p<-ggplot(MainGRUBY, aes(y=Srd_Cisn, x=Olej, color = as.character(Sezon))) + 
  geom_point() +
  geom_vline(xintercept = 2.2, linewidth = 1, color="black", se=FALSE) +
  theme_light()+
  labs(y="Åšrednie ciÅ›nienie atmosferyczne",
       x="JakoÅ›Ä‡ ziÃ³Å‚ [wskaÅºnik olejkÃ³w]",
       color = "Sezon",
       title = paste0("Korelacja: ",
                        round(kr$estimate, digits = 3),
                        " | P: ",
                        round(kr$p.value, digits = 3)))
ggplotly(p)
```

*Brak korelacji.*

## Korelacja w momencie wzrostu

```{r}
kr <- cor.test(Main_GdyRosnie$Olej, Main_GdyRosnie$Srd_Cisn, method = "pearson", use = "complete.obs")

Main_GdyRosnie %>%
  filter(Olej<2.4, Srd_Cisn > 0) %>%
ggplot(aes(y=as.factor(round(Srd_Cisn, digits = 1)), x=Olej, fill = as.character(Sezon)))+
  geom_boxplot() +
  geom_vline(xintercept = 2.2, linewidth = 1, color="black", se=FALSE) +
  theme_light()+
  labs(y="Åšrednie ciÅ›nienie atmosferyczne",
       x="JakoÅ›Ä‡ ziÃ³Å‚ [wskaÅºnik olejkÃ³w]",
       fill = "Sezon",
       caption = paste0("Korelacja: ",
                        round(kr$estimate, digits = 3),
                        " | P: ",
                        round(kr$p.value, digits = 3)))
```

*Brak korelacji.*

## Korelacja w momencie zbiorÃ³w

```{r}
kr <- cor.test(Main_GdyZbiory$Olej, Main_GdyZbiory$Srd_Cisn, method = "pearson", use = "complete.obs")

Main_GdyZbiory %>%
  filter(Olej<2.4, !is.nan(Srd_Cisn)) %>%
ggplot(aes(y=as.factor(round(Srd_Cisn, digits = 1)), x=Olej, fill = as.character(Sezon)))+
  geom_boxplot() +
  geom_vline(xintercept = 2.2, linewidth = 1, color="black", se=FALSE) +
  theme_light()+
  labs(y="Åšrednie ciÅ›nienie atmosferyczne",
       x="JakoÅ›Ä‡ ziÃ³Å‚ [wskaÅºnik olejkÃ³w]",
       fill = "Sezon",
       caption = paste0("Korelacja: ",
                        round(kr$estimate, digits = 3),
                        " | P: ",
                        round(kr$p.value, digits = 3)))
```

*Brak korelacji.*
:::

**Hipoteza**: Potwierdzona ğŸŸ¢

## OdpowiedÅº na hipotezÄ™ 3.4

"PrÄ™dkoÅ›Ä‡ wiatru nie wpÅ‚ywa znacznie na jakoÅ›Ä‡ upraw tymianku."

::: panel-tabset
## Korelacja w momencie przyjÄ™cia

```{r}
kr <- cor.test(MainGRUBY$Olej, MainGRUBY$Srd_Wiatr, method = "pearson", use = "complete.obs")

p<-ggplot(MainGRUBY, aes(y=Srd_Wiatr, x=Olej, color = as.character(Sezon))) + 
  geom_vline(xintercept = 2.2, linewidth = 1, color="black", se=FALSE) +
  geom_point()+
  theme_light()+
  labs(y="Åšredni wiatr [w m/s]",
       x="JakoÅ›Ä‡ ziÃ³Å‚ [wskaÅºnik olejkÃ³w]",
       color = "Sezon",
       title = paste0("Korelacja: ",
                        round(kr$estimate, digits = 3),
                        " | P: ",
                        round(kr$p.value, digits = 3)))
ggplotly(p)
```

*Brak korelacji.*

## Korelacja w momencie wzrostÃ³w

```{r}
kr <- cor.test(Main_GdyRosnie$Olej, Main_GdyRosnie$Srd_Wiatr, method = "pearson", use = "complete.obs")

Main_GdyRosnie %>%
  filter(Olej<2.4) %>%
ggplot(aes(y=as.factor(round(Srd_Wiatr, digits = 1)), x=Olej, fill = as.character(Sezon)))+
  geom_boxplot() +
  geom_vline(xintercept = 2.2, linewidth = 1, color="black", se=FALSE) +
  theme_light()+
  labs(y="Åšredni wiatr [w m/s]",
       x="JakoÅ›Ä‡ ziÃ³Å‚ [wskaÅºnik olejkÃ³w]",
       fill = "Sezon",
       caption = paste0("Korelacja: ",
                        round(kr$estimate, digits = 3),
                        " | P: ",
                        round(kr$p.value, digits = 3)))
```

*Brak korelacji.*

## Korelacja w momencie zbiorÃ³w

```{r}
kr <- cor.test(Main_GdyZbiory$Olej, Main_GdyZbiory$Srd_Wiatr, method = "pearson", use = "complete.obs")

Main_GdyZbiory %>%
  filter(Olej<2.4, !is.nan(Srd_Wiatr)) %>%
ggplot(aes(y=as.factor(round(Srd_Wiatr, digits = 1)), x=Olej, fill = as.character(Sezon)))+
  geom_boxplot() +
  geom_vline(xintercept = 2.2, linewidth = 1, color="black", se=FALSE) +
  theme_light()+
  labs(y="Åšredni wiatr [w m/s]",
       x="JakoÅ›Ä‡ ziÃ³Å‚ [wskaÅºnik olejkÃ³w]",
       fill = "Sezon",
       caption = paste0("Korelacja: ",
                        round(kr$estimate, digits = 3),
                        " | P: ",
                        round(kr$p.value, digits = 3)))
```

*Brak korelacji.*
:::

**Hipoteza**: Potwierdzona ğŸŸ¢

## Podsumowanie pytania 3

â€œJak warunki atmosferyczne wpÅ‚ywajÄ… na jakoÅ›Ä‡ i iloÅ›Ä‡ tymianku?â€

-   DuÅ¼e nasÅ‚onecznienie w miesiÄ…cach siania i wzrostu tymianku pozytywnie wpÅ‚ywajÄ… na jego iloÅ›Ä‡.

------------------------------------------------------------------------

------------------------------------------------------------------------

------------------------------------------------------------------------

# Podsumowanie

W danych nie zawiera siÄ™ dokÅ‚adna data zasiania i zbiorÃ³w przyjÄ™tych ziÃ³Å‚. UniemoÅ¼liwia to bardziej szczegÃ³Å‚owÄ… analizÄ™ i jest to najprawdopodobniej powÃ³d obalenia czÄ™Å›ci hipotez.z

Ekosystem, i powiÄ…zane z nim rolnictwo jest bardzo skomplikowanym systemem, ktÃ³ry ciÄ™Å¼ko jest sprowadziÄ‡ do prostych korelacji.

-   CiepÅ‚y grunt podczas wzrostu tymianku ma lekki pozytywny wpÅ‚yw na jego jakoÅ›Ä‡

-   DuÅ¼e nasÅ‚onecznienie w miesiÄ…cach siania i wzrostu tymianku pozytywnie wpÅ‚ywajÄ… na jego iloÅ›Ä‡.

-   *Dane nie pokazaÅ‚y Å¼adnej istotnej korelacji pomiÄ™dzy sytuacjÄ… przy gruncie a iloÅ›ciÄ… tymianku*

-   *Im wyÅ¼szy stan wody w rzekach tym niÅ¼sze olejki w zioÅ‚ach.*

-   *Im wiÄ™ksza wilgotnoÅ›Ä‡ tym mniejsza wilgoÄ‡ ziÃ³Å‚ (spowodowane nadmiernym suszeniem).*

-   Åšrednie opady w miesiÄ…cach zbiorÃ³w majÄ… pozytywny wpÅ‚ywaÄ‡ na jakoÅ›Ä‡ tymianku.
